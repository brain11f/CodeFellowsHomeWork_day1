Restructured using init function. Got assistance from David Zager at OK Rocket. 
